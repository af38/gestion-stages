<div class="flex flex-col relative overflow-x-auto mt-4 rounded-lg min-h-96">
    <input [(ngModel)]="query" (ngModelChange)="getAllResps()" type="search" class="block w-1/3 p-2.5 text-sm border-gray-300 border rounded-lg mb-2 focus:ring-blue-500 focus:border-blue-500" placeholder="recherch">
    <table class="w-full text-sm text-left rtl:text-right text-black shadow-md mt-2">
        <thead class="text-xs text-black uppercase bg-gray-200 shadow-md">
            <tr>
                <th scope="col" class="px-6 py-3">Nom</th>
                <th scope="col" class="px-6 py-3">Prénom</th>
                <th scope="col" class="px-6 py-3">Email</th>
                <th scope="col" class="px-6 py-3">Actions</th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let resp of resps | paginate: { itemsPerPage: 5, currentPage: page, totalItems: totalLength }" class="bg-white border-b">
                <td class="px-6 py-4">{{resp.utilisateur.nom}}</td>
                <td class="px-6 py-4">{{resp.utilisateur.prenom}}</td>
                <td class="px-6 py-4">{{resp.utilisateur.email}}</td>
                <td class="px-6 py-4">
                    <p-button (click)="showDialogView(resp)" icon="pi pi-eye" [rounded]="true" [raised]="true"></p-button>
                    <p-button (click)="showDialogEdit(resp)" icon="pi pi-pencil" [rounded]="true" [raised]="true"  severity="info" class="mx-3"></p-button>
                    <p-button (click)="deleteResp(resp.idResp)" icon="pi pi-trash" [rounded]="true" [raised]="true"  severity="danger"></p-button>
                </td>
            </tr>
        </tbody>
    </table>
</div>

<!-- delete confirmation modal -->
<p-toast></p-toast>
<p-confirmDialog #cd>
    <ng-template pTemplate="headless" let-message>
        <div class="flex flex-col gap-4 items-center p-5  rounded-lg bg-white">
            <div class="rounded-full bg-red-600 inline-flex justify-center items-center h-24 w-24">
                <i class="pi pi-question text-5xl text-white"></i>
            </div>

            <span class="font-bold text-2xl block mb-2 mt-4">
                {{ message.header }}
            </span>

            <p class="mb-0">{{ message.message }}</p>

            <div class=" w-full flex items-center gap-2 mt-4">
                <button
                    pButton
                    label="supprimer"
                    (click)="cd.accept()"
                    size="small"
                    [outlined]="true"
                    severity="danger"
                    class="w-32">
                </button>
                <button
                    pButton
                    label="Annuler"
                    (click)="cd.reject()"
                    size="small"
                    class="w-32 ">
                </button>
            </div>
        </div>
    </ng-template>
</p-confirmDialog>

    <!-- start pagination -->
    <div class="pagination text-center mt-4">
        <pagination-controls
            (pageChange)="page = $event"
            previousLabel="précédent"
            nextLabel="suivant">
        </pagination-controls>
    </div>
    <!-- end pagination -->

    @if(selectedResp){

        <!-- resp profile -->
        <p-dialog header="voir" class="text-center" [modal]="true" [(visible)]="visible_view" [style]="{width: '40vh'}" [draggable]="false" [resizable]="false" [breakpoints]="{ '960px': '75vw' }">
            <div class="grid grid-cols-2">
                <div class="flex justify-center text-left">
                    <div>
                        <span class="block mb-3 font-semibold">Nom</span>
                        <span class="block mb-3 font-semibold">Prénom</span>
                        <span class="block mb-3 font-semibold">email</span>
                        <span class="block mb-3 font-semibold">Numéro de téléphone</span>
                    </div>
                </div>
                <div class="flex justify-center text-left">
                    <div>
                        <span class="block mb-3">{{selectedResp.utilisateur.nom}}</span>
                        <span class="block mb-3">{{selectedResp.utilisateur.prenom}}</span>
                        <span class="block mb-3">{{selectedResp.utilisateur.email}}</span>
                        <span class="block mb-3">{{selectedResp.utilisateur.numTel}}</span>
                    </div>
                </div>
            </div>
        </p-dialog>

        <!-- resp edit -->
        <p-dialog header="modifier" class="text-center" [modal]="true" [(visible)]="visible_edit" [style]="{width: '40vh'}" [draggable]="false" [resizable]="false" [breakpoints]="{ '960px': '75vw' }">
                   <!-- edit form -->
                <div class="flex justify-center text-left ">
                    <form [formGroup]="formGroup" class="w-full" (ngSubmit)="update($event)">
                            <div class = "grid grid-cols-1 sm:grid-cols-2 gap-5 mt-5 w-full">

                                <!-- Nom -->
                                <div>
                                    <label class="block mb-2 text-sm font-medium" for="">nom</label>
                                    <input type="text" formControlName = "nom" [value]="selectedResp.nom"  class="block w-full p-2.5 text-sm border-gray-300 border rounded-lg focus:ring-blue-500 focus:border-blue-500">
                                    @if(getError("nom")){
                                        <span class="error">{{getError("nom")}}</span>
                                    }
                                </div>

                                <!-- Prenom -->
                                <div>
                                    <label class="block mb-2 text-sm font-medium" for="">prenom</label>
                                    <input type="text" formControlName = "prenom"  class="block w-full p-2.5 text-sm border-gray-300 border rounded-lg focus:ring-blue-500 focus:border-blue-500">
                                    @if(getError("prenom")){
                                        <span class="error">{{getError("prenom")}}</span>
                                    }
                                </div>

                                <!-- Email -->
                                <div>

                                    <label class="block mb-2 text-sm font-medium" for="">email</label>
                                    <input type="email" formControlName = "email" class="block w-full p-2.5 text-sm border-gray-300 border rounded-lg focus:ring-blue-500 focus:border-blue-500">
                                    @if(getError("email")){
                                        <span class="error">{{getError("email")}}</span>
                                    }
                                </div>

                            </div>
                            <button type="submit" class="w-full mt-5 rounded-md bg-slate-600 text-center py-3 text-white" >modifier</button>
                    </form>
                </div>

        </p-dialog>
    }



